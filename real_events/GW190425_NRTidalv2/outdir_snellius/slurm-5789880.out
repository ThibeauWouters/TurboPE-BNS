Thu Apr  4 17:17:40 CEST 2024
[cuda(id=0)]
0.03125
Initializing heterodyned likelihood..
Finding reference parameters..
Starting the optimizer
Optimization time: 184.45467567443848 seconds, 3.0742445945739747 minutes.
Ref params found by evosax:
{'M_c': Array(1.48691818, dtype=float64), 'eta': Array(0.241871, dtype=float64), 's1_z': Array(0.04999867, dtype=float64), 's2_z': Array(0.00045155, dtype=float64), 'lambda_1': Array(124.89143138, dtype=float64), 'lambda_2': Array(505.92929128, dtype=float64), 'd_L': Array(62.20843724, dtype=float64), 't_c': Array(0.04139502, dtype=float64), 'phase_c': Array(5.10878036, dtype=float64), 'iota': Array(1.2916141, dtype=float64), 'psi': Array(0.24112725, dtype=float64), 'ra': Array(4.03454026, dtype=float64), 'dec': Array(0.52655272, dtype=float64)}
Overriding with reference parameters:
ref_params for relative binning:
{'M_c': 1.48691818, 'eta': 0.241871, 's1_z': 0.04999867, 's2_z': 0.00045155, 'lambda_1': 124.89143138, 'lambda_2': 505.92929128, 'd_L': 62.20843724, 't_c': 0.04139502, 'phase_c': 5.10878036, 'iota': 1.2916141, 'psi': 0.24112725, 'ra': 4.03454026, 'dec': 0.52655272}
Constructing reference waveforms..
Running with n_bins  =  200
INFO: Using MALA as local sampler
No autotune found, use input sampler_params
Training normalizing flow

Tuning global sampler:   0%|          | 0/400 [00:00<?, ?it/s]
Tuning global sampler:   0%|          | 1/400 [02:10<14:30:33, 130.91s/it]
Tuning global sampler:   0%|          | 2/400 [02:19<6:30:03, 58.80s/it]  
Tuning global sampler:   1%|          | 3/400 [02:26<3:54:51, 35.49s/it]
Tuning global sampler:   1%|          | 4/400 [02:34<2:42:08, 24.57s/it]
Tuning global sampler:   1%|▏         | 5/400 [02:42<2:01:55, 18.52s/it]
Tuning global sampler:   2%|▏         | 6/400 [02:50<1:38:47, 15.04s/it]
Tuning global sampler:   2%|▏         | 7/400 [02:58<1:23:01, 12.68s/it]
Tuning global sampler:   2%|▏         | 8/400 [03:06<1:12:32, 11.10s/it]
Tuning global sampler:   2%|▏         | 9/400 [03:14<1:05:28, 10.05s/it]
Tuning global sampler:   2%|▎         | 10/400 [03:21<1:00:18,  9.28s/it]
Tuning global sampler:   3%|▎         | 11/400 [03:30<58:27,  9.02s/it]  
Tuning global sampler:   3%|▎         | 12/400 [03:37<55:48,  8.63s/it]
Tuning global sampler:   3%|▎         | 13/400 [03:45<54:02,  8.38s/it]
Tuning global sampler:   4%|▎         | 14/400 [03:53<52:40,  8.19s/it]
Tuning global sampler:   4%|▍         | 15/400 [04:01<51:52,  8.09s/it]
Tuning global sampler:   4%|▍         | 16/400 [04:09<52:12,  8.16s/it]
Tuning global sampler:   4%|▍         | 17/400 [04:17<51:23,  8.05s/it]
Tuning global sampler:   4%|▍         | 18/400 [04:25<50:40,  7.96s/it]
Tuning global sampler:   5%|▍         | 19/400 [04:32<50:06,  7.89s/it]
Tuning global sampler:   5%|▌         | 20/400 [04:41<50:56,  8.04s/it]
Tuning global sampler:   5%|▌         | 21/400 [04:49<50:20,  7.97s/it]
Tuning global sampler:   6%|▌         | 22/400 [04:56<49:48,  7.91s/it]
Tuning global sampler:   6%|▌         | 23/400 [05:04<49:26,  7.87s/it]
Tuning global sampler:   6%|▌         | 24/400 [05:12<49:08,  7.84s/it]
Tuning global sampler:   6%|▋         | 25/400 [05:20<50:00,  8.00s/it]
Tuning global sampler:   6%|▋         | 26/400 [05:28<49:28,  7.94s/it]
Tuning global sampler:   7%|▋         | 27/400 [05:36<49:06,  7.90s/it]
Tuning global sampler:   7%|▋         | 28/400 [05:44<48:49,  7.88s/it]
Tuning global sampler:   7%|▋         | 29/400 [05:52<49:41,  8.04s/it]
Tuning global sampler:   8%|▊         | 30/400 [06:00<48:58,  7.94s/it]
Tuning global sampler:   8%|▊         | 31/400 [06:08<48:29,  7.89s/it]
Tuning global sampler:   8%|▊         | 32/400 [06:15<48:09,  7.85s/it]
Tuning global sampler:   8%|▊         | 33/400 [06:23<47:57,  7.84s/it]
Tuning global sampler:   8%|▊         | 34/400 [06:31<47:23,  7.77s/it]
Tuning global sampler:   9%|▉         | 35/400 [06:39<48:07,  7.91s/it]
Tuning global sampler:   9%|▉         | 36/400 [06:47<47:30,  7.83s/it]
Tuning global sampler:   9%|▉         | 37/400 [06:54<47:03,  7.78s/it]
Tuning global sampler:  10%|▉         | 38/400 [07:02<46:41,  7.74s/it]
Tuning global sampler:  10%|▉         | 39/400 [07:10<47:35,  7.91s/it]
Tuning global sampler:  10%|█         | 40/400 [07:18<46:57,  7.83s/it]
Tuning global sampler:  10%|█         | 41/400 [07:26<46:31,  7.77s/it]
Tuning global sampler:  10%|█         | 42/400 [07:33<46:09,  7.74s/it]
Tuning global sampler:  11%|█         | 43/400 [07:41<45:51,  7.71s/it]
Tuning global sampler:  11%|█         | 44/400 [07:49<46:41,  7.87s/it]
Tuning global sampler:  11%|█▏        | 45/400 [07:57<46:02,  7.78s/it]
Tuning global sampler:  12%|█▏        | 46/400 [08:04<45:35,  7.73s/it]
Tuning global sampler:  12%|█▏        | 47/400 [08:12<45:19,  7.70s/it]
Tuning global sampler:  12%|█▏        | 48/400 [08:20<45:03,  7.68s/it]
Tuning global sampler:  12%|█▏        | 49/400 [08:28<45:59,  7.86s/it]
Tuning global sampler:  12%|█▎        | 50/400 [08:36<45:35,  7.82s/it]
Tuning global sampler:  13%|█▎        | 51/400 [08:43<45:09,  7.76s/it]
Tuning global sampler:  13%|█▎        | 52/400 [08:51<44:50,  7.73s/it]
Tuning global sampler:  13%|█▎        | 53/400 [08:58<44:32,  7.70s/it]
Tuning global sampler:  14%|█▎        | 54/400 [09:07<45:22,  7.87s/it]
Tuning global sampler:  14%|█▍        | 55/400 [09:14<44:50,  7.80s/it]
Tuning global sampler:  14%|█▍        | 56/400 [09:22<44:27,  7.76s/it]
Tuning global sampler:  14%|█▍        | 57/400 [09:30<44:07,  7.72s/it]
Tuning global sampler:  14%|█▍        | 58/400 [09:37<43:50,  7.69s/it]
Tuning global sampler:  15%|█▍        | 59/400 [09:45<43:35,  7.67s/it]
Tuning global sampler:  15%|█▌        | 60/400 [09:53<44:28,  7.85s/it]
Tuning global sampler:  15%|█▌        | 61/400 [10:01<43:54,  7.77s/it]
Tuning global sampler:  16%|█▌        | 62/400 [10:08<43:34,  7.73s/it]
Tuning global sampler:  16%|█▌        | 63/400 [10:16<43:18,  7.71s/it]
Tuning global sampler:  16%|█▌        | 64/400 [10:24<43:00,  7.68s/it]
Tuning global sampler:  16%|█▋        | 65/400 [10:32<43:55,  7.87s/it]
Tuning global sampler:  16%|█▋        | 66/400 [10:40<43:25,  7.80s/it]
Tuning global sampler:  17%|█▋        | 67/400 [10:47<43:02,  7.76s/it]
Tuning global sampler:  17%|█▋        | 68/400 [10:55<42:44,  7.72s/it]
Tuning global sampler:  17%|█▋        | 69/400 [11:03<42:28,  7.70s/it]
Tuning global sampler:  18%|█▊        | 70/400 [11:11<43:19,  7.88s/it]
Tuning global sampler:  18%|█▊        | 71/400 [11:18<42:48,  7.81s/it]
Tuning global sampler:  18%|█▊        | 72/400 [11:26<42:22,  7.75s/it]
Tuning global sampler:  18%|█▊        | 73/400 [11:34<42:04,  7.72s/it]
Tuning global sampler:  18%|█▊        | 74/400 [11:41<41:49,  7.70s/it]
Tuning global sampler:  19%|█▉        | 75/400 [11:49<41:30,  7.66s/it]
Tuning global sampler:  19%|█▉        | 76/400 [11:57<42:22,  7.85s/it]
Tuning global sampler:  19%|█▉        | 77/400 [12:05<41:55,  7.79s/it]
Tuning global sampler:  20%|█▉        | 78/400 [12:13<41:33,  7.74s/it]
Tuning global sampler:  20%|█▉        | 79/400 [12:20<41:15,  7.71s/it]
Tuning global sampler:  20%|██        | 80/400 [12:28<41:00,  7.69s/it]
Tuning global sampler:  20%|██        | 81/400 [12:36<41:50,  7.87s/it]
Tuning global sampler:  20%|██        | 82/400 [12:44<41:21,  7.80s/it]
Tuning global sampler:  20%|██        | 82/400 [12:51<49:53,  9.41s/it]
Compiling MALA body
Early stopping: global acceptance target rate achieved
Starting Production run

Production run:   0%|          | 0/40 [00:00<?, ?it/s]
Production run:   2%|▎         | 1/40 [00:00<00:26,  1.44it/s]
Production run:   5%|▌         | 2/40 [00:01<00:26,  1.45it/s]
Production run:   8%|▊         | 3/40 [00:02<00:25,  1.45it/s]
Production run:  10%|█         | 4/40 [00:02<00:24,  1.45it/s]
Production run:  12%|█▎        | 5/40 [00:03<00:24,  1.45it/s]
Production run:  15%|█▌        | 6/40 [00:04<00:23,  1.45it/s]
Production run:  18%|█▊        | 7/40 [00:04<00:22,  1.45it/s]
Production run:  20%|██        | 8/40 [00:05<00:22,  1.45it/s]
Production run:  22%|██▎       | 9/40 [00:06<00:21,  1.45it/s]
Production run:  25%|██▌       | 10/40 [00:06<00:20,  1.45it/s]
Production run:  28%|██▊       | 11/40 [00:07<00:20,  1.45it/s]
Production run:  30%|███       | 12/40 [00:08<00:19,  1.45it/s]
Production run:  32%|███▎      | 13/40 [00:08<00:18,  1.45it/s]
Production run:  35%|███▌      | 14/40 [00:09<00:17,  1.45it/s]
Production run:  38%|███▊      | 15/40 [00:10<00:17,  1.45it/s]
Production run:  40%|████      | 16/40 [00:11<00:16,  1.45it/s]
Production run:  42%|████▎     | 17/40 [00:11<00:15,  1.45it/s]
Production run:  45%|████▌     | 18/40 [00:12<00:15,  1.45it/s]
Production run:  48%|████▊     | 19/40 [00:13<00:14,  1.45it/s]
Production run:  50%|█████     | 20/40 [00:13<00:13,  1.45it/s]
Production run:  52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s]
Production run:  55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s]
Production run:  57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s]
Production run:  60%|██████    | 24/40 [00:16<00:11,  1.45it/s]
Production run:  62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s]
Production run:  65%|██████▌   | 26/40 [00:17<00:09,  1.45it/s]
Production run:  68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s]
Production run:  70%|███████   | 28/40 [00:19<00:08,  1.45it/s]
Production run:  72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s]
Production run:  75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s]
Production run:  78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s]
Production run:  80%|████████  | 32/40 [00:22<00:05,  1.45it/s]
Production run:  82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s]
Production run:  85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s]
Production run:  88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s]
Production run:  90%|█████████ | 36/40 [00:24<00:02,  1.45it/s]
Production run:  92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s]
Production run:  95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s]
Production run:  98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]
Production run: 100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
Production run: 100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
Training summary
==========
M_c: 1.487 +/- 0.000
eta: 0.248 +/- 0.005
s1_z: 0.021 +/- 0.021
s2_z: 0.017 +/- 0.023
lambda_1: 840.114 +/- 918.583
lambda_2: 1160.044 +/- 1131.498
d_L: 146.966 +/- 56.901
t_c: 0.023 +/- 0.019
phase_c: 3.184 +/- 1.767
iota: 1.387 +/- 0.777
psi: 1.571 +/- 0.887
ra: 2.775 +/- 1.618
dec: 0.028 +/- 0.563
Log probability: 54.758 +/- 283.313
Local acceptance: 0.990 +/- 0.101
Global acceptance: 0.034 +/- 0.180
Max loss: 22.781, Min loss: 4.802
Production summary
==========
M_c: 1.487 +/- 0.000
eta: 0.248 +/- 0.003
s1_z: 0.022 +/- 0.020
s2_z: 0.017 +/- 0.023
lambda_1: 583.509 +/- 648.277
lambda_2: 881.087 +/- 896.016
d_L: 132.129 +/- 44.187
t_c: 0.019 +/- 0.017
phase_c: 3.157 +/- 1.800
iota: 1.484 +/- 0.792
psi: 1.545 +/- 0.898
ra: 2.413 +/- 1.608
dec: -0.102 +/- 0.566
Log probability: 60.326 +/- 2.700
Local acceptance: 0.986 +/- 0.116
Global acceptance: 0.102 +/- 0.303
Saving samples to ./outdir/results_training.npz
Saving the NF
Saving the jim hyperparameters
Finished successfully
Time taken: 1106.6818251609802 seconds (18.444697086016337 minutes)
Saving runtime
Copying to: /home/twouters2/TurboPE-BNS/real_events/GW190425_NRTidalv2/outdir_snellius/
Directory already exists: /home/twouters2/TurboPE-BNS/real_events/GW190425_NRTidalv2/outdir_snellius/
First running ls:
GW190425_snellius.py
utils_plotting.py
OK, copying now!
DONE

JOB STATISTICS
==============
Job ID: 5789880
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 00:18:50
CPU Efficiency: 5.57% of 05:38:24 core-walltime
Job Wall-clock time: 00:18:48
Memory Utilized: 4.88 GB
Memory Efficiency: 32.51% of 15.00 GB
